services:
  web:
    build: .
    container_name: geiger-website
    ports:
      - "8080:4000"  # Jekyll serves on port 4000
    volumes:
      - .:/srv/jekyll
    restart: unless-stopped
    command: >
      sh -c "
        cd /srv/jekyll &&
        bundle config set --global path '/usr/local/bundle' 2>/dev/null || true &&
        bundle install 2>/dev/null || true &&
        bundle exec jekyll serve --host 0.0.0.0 --port 4000 --watch --force_polling 2>&1 || 
        jekyll serve --host 0.0.0.0 --port 4000 --watch --force_polling
      "
